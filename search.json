[{"path":"index.html","id":"welcome","chapter":"Welcome!","heading":"Welcome!","text":"Welcome R clinical study reports submission.\nClinical study reports (CSR) essential parts clinical trial development.\nCSR “integrated” full scientific report individual clinical trial.ICH E3: structure content clinical study reports\nprovides guidance assist sponsors development CSR.\nbook, learn use R prepare CSR submit regulatory agencies.work--progress draft book.","code":""},{"path":"index.html","id":"list-of-authors-and-contributors","chapter":"Welcome!","heading":"List of Authors and Contributors","text":"document maintained community.\nreading document, can contributor well.\nquality document relies .Author: contribute majority content least one chapter.Contributor: contribute least one commit source code","code":""},{"path":"intro.html","id":"intro","chapter":"1 Introduction","heading":"1 Introduction","text":"","code":""},{"path":"intro.html","id":"folder-structure","chapter":"1 Introduction","heading":"1.1 Folder structure","text":"clinical trial development, source code needs developed maintained generate deliver\nStudy Data Tabulation Model (SDTM), Analysis Dataset Model (ADaM) datasets tables, listings, figures (TLFs).\ntypical example Phase 3 clinical trial hundreds TLFs required submission.\nConsidering amount programs required effort,\nconsistent well-defined folder structure crucial \nmanaging clinical trial analysis reporting (&R) project.recommend using\nR package folder structure\norganize &R related source code documentation clinical trial &R project.\nR package folder structure well defined widely used R community repositories (e.g. CRAN).consistent approach using R package folder structure\nsimplifies communication developers within across organizations.new R developer,\nessential step develop R packages\nwant share work others.\nlearn one folder structure widely used\nR community outstanding tutorials tools free.new R developer,\nessential step develop R packages\nwant share work others.\nlearn one folder structure widely used\nR community outstanding tutorials tools free.experienced R developer, minimal learning curve.experienced R developer, minimal learning curve.organization, simplifies process, tool, template,\ntraining development, unified folder structure used\ndevelop maintain standard tool analysis projects.organization, simplifies process, tool, template,\ntraining development, unified folder structure used\ndevelop maintain standard tool analysis projects.workflow around R package can also improve\ntraceability reproducibility analysis project (Marwick, Boettiger, Mullen 2018).revisit folder structure discuss project management clinical trail project.addition, R package folder structure also recommended\ndevelop Shiny apps discussed\nChapter 20 Master Shiny book\nEngineering Production-Grade Shiny Apps book.","code":""},{"path":"intro.html","id":"in-this-book","chapter":"1 Introduction","heading":"1.2 In this book","text":"book intermediate-level book \nassuming readers R programming clinical development knowledge.\nassumption part :Part 1, “Delivering TLFs CSR” provides general information examples\ncreate tables, listings, figures.\npart, assume readers individual contributors clinical project\nexperience R programming.\nexpect readers familiar data manipulation R.\ngood references include Hands-Programming R,\nR Data Science \nData Manipulation R.Part 1, “Delivering TLFs CSR” provides general information examples\ncreate tables, listings, figures.\npart, assume readers individual contributors clinical project\nexperience R programming.\nexpect readers familiar data manipulation R.\ngood references include Hands-Programming R,\nR Data Science \nData Manipulation R.Part 2, “Clinical Trial Project” provides general information\nexamples manage clinical trial &R project.\npart, assume reader project lead experience R package development.\ngood reference includes R packages \ntidyverse style guide.Part 2, “Clinical Trial Project” provides general information\nexamples manage clinical trial &R project.\npart, assume reader project lead experience R package development.\ngood reference includes R packages \ntidyverse style guide.Part 3, “eCTD Submission package”\nprovides general information preparing\nsubmission package related clinical study report (CSR) \nelectronic Common Technical Document (eCTD).\npart, assume reader project lead clinical project\nexperience R package development submission.Part 3, “eCTD Submission package”\nprovides general information preparing\nsubmission package related clinical study report (CSR) \nelectronic Common Technical Document (eCTD).\npart, assume reader project lead clinical project\nexperience R package development submission.","code":""},{"path":"intro.html","id":"philosophy","chapter":"1 Introduction","heading":"1.3 Philosophy","text":"share philosophy described \nSection 1.1 R Packages book\nquote .“Anything can automated, automated.”“little possible hand. much possible functions.”“goal spend time thinking want \nrather thinking minutiae package structure.”","code":""},{"path":"overview.html","id":"overview","chapter":"2 Overview","heading":"2 Overview","text":"","code":""},{"path":"overview.html","id":"background","chapter":"2 Overview","heading":"2.1 Background","text":"clinical trials, critical step \nsubmission regulatory agencies.\nElectronic Common Technical Document (eCTD)\nbecome worldwide regulatory submission standard format.\nexample, United States Food Drug Administration (US FDA) required new drug applications, biologics license applications must submitted using eCTD format. Clinical Data Interchange Standards Consortium (CDISC) provided \npilot project following ICH E3 guidance.Within eCTD, clinical study reports (CSRs) located module 5.\nICH E3 guidance provides\ncompilation structure content clinical study reports.typical CSR contains full details methods results individual clinical study.\nsupport statistical anlaysis, large number tables, listings figures \nincorporated main text appendices.\nCDISC pilot project, \nexample CSR\nalso provided. interested examples clinical study reports,\nEuropean Medicines Agency (EMA) publishes clinical data including\nclinical study reports submitted pharmaceutical companies\nEMA clinical data website.Building CSRs teamwork clinicians, medical writers, statisticians, statistical programmers\nrelevant specialists experts biomarkers.\n, focus work deliverables completed statisticians statistical programmers.\norganization, commonly work together \ndefine, develop, validate deliver tables, listings, figures (TLFs) required CSR \nsummarize safety /safety pharmaceutical product.\nMicrosoft Word widely used prepare CSR pharmaceutical industry.\nTherefore, rtf, doc, docx commonly used formats deliverables.chapter, focus illustrate create tables, listings, figures (TLFs) RTF format\ncommonly used CSR. examples compliance \nFDA’s Portable Document Format (PDF) SpecificationsFDA’s PDF specification general reference, organization can define\nspecific TLF format requirement can different examples book.","code":""},{"path":"overview.html","id":"structure-and-content","chapter":"2 Overview","heading":"2.2 Structure and Content","text":"rest chapter, following \nICH E3 guidance\nstructure content clinical study reports.CSR, TLFs located inSection 10: Study participantsSection 11: Efficacy evaluationSection 12: Safety evaluationSection 14: Tables, listings figures referrals included textSection 16: Appendices","code":""},{"path":"overview.html","id":"datasets","chapter":"2 Overview","heading":"2.3 Datasets","text":"used publicly available CDISC pilot\nstudy data located CDISC Bitbucket repository.simplicity, downloaded datasets adam_data folder \nproject transfer .xpt format sas7bdat format.dataset structure follows\nCDISC Analysis Data Model (ADaM).","code":""},{"path":"overview.html","id":"tools","chapter":"2 Overview","heading":"2.4 Tools","text":"part, mainly use R packages illustrate\ndeliver TLFs CSR.tidyverse: prepare reporting ready datasets.r2rtf: create RTF outputs","code":""},{"path":"overview.html","id":"tidyverse","chapter":"2 Overview","heading":"2.4.1 tidyverse","text":"tidyverse collection R packages simplify workflow manipulate,\nvisualize analyze data R.\nR packages share\ntidy tools manifesto\neasy use interactive data analysis.RStudio provided outstanding cheatsheets,\ntutorials tidyverse.also books introduce tidyverse.\nassume reader experience using tidyverse book.tidyverse cookbookR Data Science","code":""},{"path":"overview.html","id":"r2rtf","chapter":"2 Overview","heading":"2.4.2 r2rtf","text":"r2rtf R package create production-ready tables figures RTF format.\nR package designed toprovide simple “verb” functions correspond component table,\nhelp translate data frame table RTF file.enable pipes (%>%).focus table format.\nData manipulation analysis shall handled R packages. (e.g. tidyverse)creating RTF table need :Figure table layout.Figure table layout.Split layout small tasks form computer program.Split layout small tasks form computer program.Execute program.Execute program.provided brief introduction r2rtf show transfer\ndata frames Table, Listing, Figures (TLFs).extended examples features covered \nr2rtf package website.explore basic RTF generation verbs r2rtf,\n’ll use dataset r2rtf_adae saved r2rtf package.\ndataset contains adverse events (AE) information clinical trial.meaning relevant variables.\ninformation can found help page dataset (?r2rtf_adae)example consider three variables:USUBJID: Unique Subject IdentifierTRTA: Actual TreatmentAEDECOD: Dictionary-Derived Termdplyr tidyr packages within tidyverse used\ndata manipulation create data frame\ncontains information want add RTF table.Now dataset tbl preparing final RTF table.r2rtf aims provide one function type table layout.\nCommonly used verbs include:rtf_page: RTF page informationrtf_title: RTF title informationrtf_colheader: RTF column header informationrtf_body: RTF table body informationrtf_footnote: RTF footnote informationrtf_source: RTF data source informationAll verbs designed enable usage pipes (%>%).\nfull list functions can found \nr2rtf package referenceA minimal example illustrates combine verbs using pipes create RTF table.rtf_body used define table body layout.rtf_encode transfers table layout information RTF syntax.write_rtf save RTF encoding file file extension .rtfIf want adjust width column \nprovide space first column,\ncan achieved updating col_rel_width argument\nrtf_body function.example, input col_rel_width vector\nlength number columns.\nargument defines relative width column\nwithin pre-defined total column width.example, defined relative width 3:2:2:2.\nratio col_rel_width used.\nTherefore equivalent use col_rel_width = c(6,4,4,4)\ncol_rel_width = c(1.5,1,1,1).previous example, found issue misaligned column header.\ncan fix issue using rtf_colheader function.rtf_colheader, colheader argument used provide content column header.\nuse \"|\" separate columns.example , \"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose\"\ndefine column header 4 columns.rtf_* functions rtf_body, rtf_footnote,\ntext_justification argument used align text.\nDefault \"c\" center justification.\nvary text justification column, use character vector length vector equal \nnumber columns displayed (e.g., c(\"c\",\"l\",\"r\")).possible inputs can found table .example make first column left-aligned center-aligned rest.rtf_* functions rtf_body, rtf_footnote, etc.,\nborder_left, border_right, border_top, border_bottom control cell borders.want remove top border \"Adverse Events\" header,\ncan change default value \"single\" \"\" border_top argument showed .r2rtf support 26 different border types. details can found \nr2rtf package website.example, also demonstrate possibility add multiple column headers.r2rtf R package get started page\nexamples illustrate customizetitle, subtitlefootnote, data sourcespecial characteretc.features introduced first use rest chapters.R packages can create TLFs .rtf .docx format.\nInterested readers can refer “Microsoft/LibreOffice Formats” section \nCRAN Task View: Reproducible Research\noverview.","code":"\nr2rtf_adae %>%\n  select(USUBJID, TRTA, AEDECOD) %>%\n  head(4)##       USUBJID    TRTA                   AEDECOD\n## 1 01-701-1015 Placebo APPLICATION SITE ERYTHEMA\n## 2 01-701-1015 Placebo APPLICATION SITE PRURITUS\n## 3 01-701-1015 Placebo                 DIARRHOEA\n## 4 01-701-1023 Placebo                  ERYTHEMA\ntbl <- r2rtf_adae %>%\n  count(TRTA, AEDECOD) %>%\n  pivot_wider(names_from = TRTA, values_from = n, values_fill = 0)\n\ntbl %>% head(4)## # A tibble: 4 × 4\n##   AEDECOD        Placebo `Xanomeline High Dose` `Xanomeline Low Dose`\n##   <chr>            <int>                  <int>                 <int>\n## 1 ABDOMINAL PAIN       1                      2                     3\n## 2 AGITATION            2                      1                     2\n## 3 ALOPECIA             1                      0                     0\n## 4 ANXIETY              2                      0                     4\nhead(tbl) %>%\n  rtf_body() %>%                 # Step 1 Add table  attributes\n  rtf_encode() %>%               # Step 2 Convert attributes to RTF encode\n  write_rtf(\"tlf/intro-ae1.rtf\") # Step 3 Write to a .rtf file\nhead(tbl) %>%\n  rtf_body(col_rel_width = c(3, 2, 2, 2)) %>%\n  \n  # define relative width\n  rtf_encode() %>%\n  write_rtf(\"tlf/intro-ae2.rtf\")\nhead(tbl) %>%\n  \n  rtf_colheader(\n    colheader = \"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose\",\n    col_rel_width = c(3, 2, 2, 2)\n  ) %>%\n  \n  rtf_body(col_rel_width = c(3, 2, 2, 2)) %>%\n  \n  rtf_encode() %>%\n  \n  write_rtf(\"tlf/intro-ae3.rtf\")\nr2rtf:::justification()##   type      name rtf_code_text rtf_code_row\n## 1    l      left          \\\\ql       \\\\trql\n## 2    c    center          \\\\qc       \\\\trqc\n## 3    r     right          \\\\qr       \\\\trqr\n## 4    d   decimal          \\\\qj             \n## 5    j justified          \\\\qj\nhead(tbl) %>%\n  \n  rtf_body(text_justification = c(\"l\", \"c\", \"c\", \"c\")) %>%\n  \n  rtf_encode() %>%\n  \n  write_rtf(\"tlf/intro-ae5.rtf\")\nhead(tbl) %>%\n  \n  rtf_colheader(\n    colheader = \" | Treatment\",\n    col_rel_width = c(3, 6)\n  ) %>%\n  \n  rtf_colheader(\n    colheader = \"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose\",\n    border_top = c(\"\", \"single\", \"single\", \"single\"),\n    col_rel_width = c(3, 2, 2, 2)\n  ) %>%\n  \n  rtf_body(col_rel_width = c(3, 2, 2, 2)) %>%\n  \n  rtf_encode() %>%\n  \n  write_rtf(\"tlf/intro-ae7.rtf\")"},{"path":"disposition.html","id":"disposition","chapter":"3 Disposition","heading":"3 Disposition","text":"Following ICH E3 guidance,\nneed summarize accounting participants entered study,\nSection 10.1, Disposition Participants.\ndisposition participant reports numbers participants randomized,\nentered completed phase study,\nwell reasons post-randomization discontinuations,\ngrouped treatment major reason (lost follow-, adverse event, poor compliance, etc.).chapter, illustrate create disposition table .first step read relevant datasets R.\ndisposition table, required information saved ADSL dataset.\ncan use haven package read dataset.illustrate prepare report data simplified disposition participants table using variables :USUBJID: Unique subject identifierTRT01P: Planed treatmentTRT01PN: Planned treatment encodingDISCONFL: Discontinued study flagDCREASCD: Discontinued study reasonIn code , calculated participants analysis population.code , calculate number percentage participants discontinued study.use formatC() function customize numeric value 1 decimal fixed width 5.code , calculate number percentage participants completed/discontinued study different reasons.code , calculate number percentage participants complete study.\nsplit n_reason need customize row order table.code , calculate number percentage participants discontinued study different reasons.\nuse paste0(\"    \", row) add leading space individual reasons study discontinuation.Now combined individual rows whole table reporting purposes.\ntbl_disp used input r2rtf create final report.start define format output.\nhighlighted items discussed previous discussion.rtf_title defines table title.\ncan provide vector title argument.\nvalue separate line.\nformat can also controlled providing vector input text format.procedure generate disposition table can summarized follow:Step 1: Read data R, .e. adsl.Step 2: Count participants analysis population name dataset n_rand.Step 3: Count number percentage participants discontinued study, name dataset n_disc.Step 4: Count number percentage participants discontinued study different reasons, name dataset n_reason. Format using r2rtf.Step 5: Count number percentage participants completed study, name dataset n_complete.Step 6: Bind n_rand, n_disc, n_reason n_complete row. Format using r2rtf.","code":"\nlibrary(haven) # Read SAS data\nlibrary(dplyr) # Manipulate data\nlibrary(tidyr) # Manipulate data\nlibrary(r2rtf) # Reporting in RTF format\nadsl <- read_sas(\"adam_data/adsl.sas7bdat\")\nadsl %>%\n  select(USUBJID, TRT01P, TRT01PN, DISCONFL, DCREASCD) %>%\n  head(4)## # A tibble: 4 × 5\n##   USUBJID     TRT01P               TRT01PN DISCONFL DCREASCD        \n##   <chr>       <chr>                  <dbl> <chr>    <chr>           \n## 1 01-701-1015 Placebo                    0 \"\"       Completed       \n## 2 01-701-1023 Placebo                    0 \"Y\"      Adverse Event   \n## 3 01-701-1028 Xanomeline High Dose      81 \"\"       Completed       \n## 4 01-701-1033 Xanomeline Low Dose       54 \"Y\"      Sponsor Decision\nn_rand <- adsl %>%\n  group_by(TRT01PN) %>%\n  summarize(n = n()) %>%\n  pivot_wider(\n    names_from = TRT01PN,\n    names_prefix = \"n_\",\n    values_from = n\n  ) %>%\n  mutate(row = \"Participants in population\")\nn_rand## # A tibble: 1 × 4\n##     n_0  n_54  n_81 row                       \n##   <int> <int> <int> <chr>                     \n## 1    86    84    84 Participants in population\nn_disc <- adsl %>%\n  group_by(TRT01PN) %>%\n  summarize(\n    n = sum(DISCONFL == \"Y\"),\n    pct = formatC(n / n() * 100,\n      digits = 1, format = \"f\", width = 5\n    )\n  ) %>%\n  pivot_wider(\n    names_from = TRT01PN,\n    values_from = c(n, pct)\n  ) %>%\n  mutate(row = \"Discontinued\")\n\nn_disc## # A tibble: 1 × 7\n##     n_0  n_54  n_81 pct_0   pct_54  pct_81  row         \n##   <int> <int> <int> <chr>   <chr>   <chr>   <chr>       \n## 1    28    59    57 \" 32.6\" \" 70.2\" \" 67.9\" Discontinued\nn_reason <- adsl %>%\n  group_by(TRT01PN) %>%\n  mutate(n_total = n()) %>%\n  group_by(TRT01PN, DCREASCD) %>%\n  summarize(\n    n = n(),\n    pct = formatC(n / unique(n_total) * 100,\n      digits = 1, format = \"f\", width = 5\n    )\n  ) %>%\n  pivot_wider(\n    id_cols = DCREASCD,\n    names_from = TRT01PN,\n    values_from = c(n, pct),\n    values_fill = list(n = 0, pct = \"  0.0\")\n  ) %>%\n  rename(row = DCREASCD)\n\nn_reason## # A tibble: 10 × 7\n##    row                  n_0  n_54  n_81 pct_0   pct_54  pct_81 \n##    <chr>              <int> <int> <int> <chr>   <chr>   <chr>  \n##  1 Adverse Event          8    44    40 \"  9.3\" \" 52.4\" \" 47.6\"\n##  2 Completed             58    25    27 \" 67.4\" \" 29.8\" \" 32.1\"\n##  3 Death                  2     1     0 \"  2.3\" \"  1.2\" \"  0.0\"\n##  4 I/E Not Met            1     0     2 \"  1.2\" \"  0.0\" \"  2.4\"\n##  5 Lack of Efficacy       3     0     1 \"  3.5\" \"  0.0\" \"  1.2\"\n##  6 Lost to Follow-up      1     1     0 \"  1.2\" \"  1.2\" \"  0.0\"\n##  7 Physician Decision     1     0     2 \"  1.2\" \"  0.0\" \"  2.4\"\n##  8 Protocol Violation     1     1     1 \"  1.2\" \"  1.2\" \"  1.2\"\n##  9 Sponsor Decision       2     2     3 \"  2.3\" \"  2.4\" \"  3.6\"\n## 10 Withdrew Consent       9    10     8 \" 10.5\" \" 11.9\" \"  9.5\"\nn_complete <- n_reason %>% filter(row == \"Completed\")\n\nn_complete## # A tibble: 1 × 7\n##   row         n_0  n_54  n_81 pct_0   pct_54  pct_81 \n##   <chr>     <int> <int> <int> <chr>   <chr>   <chr>  \n## 1 Completed    58    25    27 \" 67.4\" \" 29.8\" \" 32.1\"\nn_reason <- n_reason %>%\n  filter(row != \"Completed\") %>%\n  mutate(row = paste0(\"    \", row))\n\nn_reason## # A tibble: 9 × 7\n##   row                        n_0  n_54  n_81 pct_0   pct_54  pct_81 \n##   <chr>                    <int> <int> <int> <chr>   <chr>   <chr>  \n## 1 \"    Adverse Event\"          8    44    40 \"  9.3\" \" 52.4\" \" 47.6\"\n## 2 \"    Death\"                  2     1     0 \"  2.3\" \"  1.2\" \"  0.0\"\n## 3 \"    I/E Not Met\"            1     0     2 \"  1.2\" \"  0.0\" \"  2.4\"\n## 4 \"    Lack of Efficacy\"       3     0     1 \"  3.5\" \"  0.0\" \"  1.2\"\n## 5 \"    Lost to Follow-up\"      1     1     0 \"  1.2\" \"  1.2\" \"  0.0\"\n## 6 \"    Physician Decision\"     1     0     2 \"  1.2\" \"  0.0\" \"  2.4\"\n## 7 \"    Protocol Violation\"     1     1     1 \"  1.2\" \"  1.2\" \"  1.2\"\n## 8 \"    Sponsor Decision\"       2     2     3 \"  2.3\" \"  2.4\" \"  3.6\"\n## 9 \"    Withdrew Consent\"       9    10     8 \" 10.5\" \" 11.9\" \"  9.5\"\ntbl_disp <- bind_rows(n_rand, n_complete, n_disc, n_reason) %>%\n  select(row, ends_with(c(\"_0\", \"_54\", \"_81\")))\n\ntbl_disp## # A tibble: 12 × 7\n##    row                            n_0 pct_0    n_54 pct_54   n_81 pct_81 \n##    <chr>                        <int> <chr>   <int> <chr>   <int> <chr>  \n##  1 \"Participants in population\"    86  <NA>      84  <NA>      84  <NA>  \n##  2 \"Completed\"                     58 \" 67.4\"    25 \" 29.8\"    27 \" 32.1\"\n##  3 \"Discontinued\"                  28 \" 32.6\"    59 \" 70.2\"    57 \" 67.9\"\n##  4 \"    Adverse Event\"              8 \"  9.3\"    44 \" 52.4\"    40 \" 47.6\"\n##  5 \"    Death\"                      2 \"  2.3\"     1 \"  1.2\"     0 \"  0.0\"\n##  6 \"    I/E Not Met\"                1 \"  1.2\"     0 \"  0.0\"     2 \"  2.4\"\n##  7 \"    Lack of Efficacy\"           3 \"  3.5\"     0 \"  0.0\"     1 \"  1.2\"\n##  8 \"    Lost to Follow-up\"          1 \"  1.2\"     1 \"  1.2\"     0 \"  0.0\"\n##  9 \"    Physician Decision\"         1 \"  1.2\"     0 \"  0.0\"     2 \"  2.4\"\n## 10 \"    Protocol Violation\"         1 \"  1.2\"     1 \"  1.2\"     1 \"  1.2\"\n## 11 \"    Sponsor Decision\"           2 \"  2.3\"     2 \"  2.4\"     3 \"  3.6\"\n## 12 \"    Withdrew Consent\"           9 \" 10.5\"    10 \" 11.9\"     8 \"  9.5\"\ntbl_disp %>%\n  \n  # Table title\n  rtf_title(\"Disposition of Participants\") %>%\n  \n  # First row of column header\n  rtf_colheader(\" | Placebo | Xanomeline Low Dose| Xanomeline High Dose\",\n    col_rel_width = c(3, rep(2, 3))\n  ) %>%\n  \n  # Second row of column header\n  rtf_colheader(\" | n | (%) | n | (%) | n | (%)\",\n    col_rel_width = c(3, rep(c(0.7, 1.3), 3)),\n    border_top = c(\"\", rep(\"single\", 6)),\n    border_left = c(\"single\", rep(c(\"single\", \"\"), 3))\n  ) %>%\n  \n  # Table body\n  rtf_body(\n    col_rel_width = c(3, rep(c(0.7, 1.3), 3)),\n    text_justification = c(\"l\", rep(\"c\", 6)),\n    border_left = c(\"single\", rep(c(\"single\", \"\"), 3))\n  ) %>%\n  \n  # Encoding RTF syntax\n  rtf_encode() %>%\n  \n  # Save to a file\n  write_rtf(\"tlf/tbl_disp.rtf\")"},{"path":"population.html","id":"population","chapter":"4 Analysis Population","heading":"4 Analysis Population","text":"Following ICH E3\nguidance,\nneed summarize participants included efficacy\nanalysis Section 11.1, Data Sets Analysed.chapter, illustrate create summary table \nanalysis population study.first step read relevant datasets R. analysis\npopulation table, required information saved ADSL\ndataset. can use haven package read dataset.illustrate prepare report data simplified analysis\npopulation table using variables :USUBJID: Unique subject identifierITTFL: Intent--treat population flagEFFFL: Efficacy population flagSAFFL: Safty population flag","code":"\nlibrary(haven) # Read SAS data\nlibrary(dplyr) # Manipulate data\nlibrary(tidyr) # Manipulate data\nlibrary(r2rtf) # Reporting in RTF format\nadsl <- read_sas(\"adam_data/adsl.sas7bdat\")\nadsl %>%\n  select(USUBJID, ITTFL, EFFFL, SAFFL) %>%\n  head(4)## # A tibble: 4 × 4\n##   USUBJID     ITTFL EFFFL SAFFL\n##   <chr>       <chr> <chr> <chr>\n## 1 01-701-1015 Y     Y     Y    \n## 2 01-701-1023 Y     Y     Y    \n## 3 01-701-1028 Y     Y     Y    \n## 4 01-701-1033 Y     Y     Y"},{"path":"population.html","id":"helper-functions","chapter":"4 Analysis Population","heading":"4.1 Helper Functions","text":"write analysis code, let’s discuss possibility reuse R\ncode writing toy helper functions.discussed R data\nscience,\n“consider writing function whenever ’ve copied \npasted block code twice”.Chapter 3, repeating steps :Format percentages using formatC() function.Calculate numbers percentages groups.create two ad-hoc functions apply rest \ntables.format numbers percentages, created function called\nfmt_num(). simple function wrapping formatC().main reason create fmt_num() function enhance \nreadability analysis code.example, can compare two versions code format \npercentage used 3 fmt_num.calculate numbers percentages participants groups, \nprovide simple (robust) wrapper function, count_by() using\ndplyr tidyr package.function can enhanced multiple ways, focus \nsimplicity readability. details writing R functions can\nfound Stat454\ncourse.using count_by() function, can simplify analysis code \n.","code":"\nfmt_num <- function(x, digits, width = digits + 4) {\n  formatC(x,\n    digits = digits,\n    format = \"f\",\n    width = width\n  )\n}\nformatC(n / n() * 100,\n  digits = 1, format = \"f\", width = 5\n)\nfmt_num(n / n() * 100, digits = 1)\ncount_by <- function(data, # Input data set\n                     grp,  # Group variable\n                     var,  # Analysis variable\n                     var_label = var, # Analysis variable label\n                     id = \"USUBJID\") { # Subject ID variable\n  data <- data %>% rename(grp = !!grp, var = !!var, id = !!id)\n\n  left_join(\n    count(data, grp, var),\n    count(data, grp, name = \"tot\"),\n    by = \"grp\",\n  ) %>%\n    mutate(\n      pct = fmt_num(100 * n / tot, digits = 1),\n      n = fmt_num(n, digits = 0),\n      npct = paste0(n, \" (\", pct, \")\")\n    ) %>%\n    pivot_wider(\n      id_cols = var,\n      names_from = grp,\n      values_from = c(n, pct, npct),\n      values_fill = list(n = \"0\", pct = fmt_num(0, digits = 0))\n    ) %>%\n    mutate(var_label = var_label)\n}\ncount_by(adsl, \"TRT01PN\", \"EFFFL\") %>% \n  select(- ends_with(c(\"_54\", \"_81\")))## # A tibble: 2 × 5\n##   var   n_0    pct_0   npct_0         var_label\n##   <chr> <chr>  <chr>   <chr>          <chr>    \n## 1 N     \"   7\" \"  8.1\" \"   7 (  8.1)\" EFFFL    \n## 2 Y     \"  79\" \" 91.9\" \"  79 ( 91.9)\" EFFFL"},{"path":"population.html","id":"analysis-code","chapter":"4 Analysis Population","heading":"4.2 Analysis Code","text":"helper functions count_by, can easily prepare report\ndataset asNow combine individual rows whole table reporting\npurposes. tbl_pop used input r2rtf create final\nreport.start define format output.procedure generate analysis population table can summarized\nfollow:Step 1: Read data R, .e., adsl.Step 2: Bind counts/percentages ITT population, \nefficacy population safety population row using \ncount_by() function.Step 3: Format output Step 2 r2rtf.","code":"\n# Derive a randomization flag\nadsl <- adsl %>% mutate(RANDFL = \"Y\")\n\npop <- count_by(adsl, \"TRT01PN\", \"RANDFL\", \n                var_label = \"Participants in Population\") %>%\n  select(var_label, starts_with(\"n_\"))\npop1 <- bind_rows(\n  count_by(adsl, \"TRT01PN\", \"ITTFL\",\n    var_label = \"Participants included in ITT population\"\n  ),\n  count_by(adsl, \"TRT01PN\", \"EFFFL\",\n    var_label = \"Participants included in efficacy population\"\n  ),\n  count_by(adsl, \"TRT01PN\", \"SAFFL\",\n    var_label = \"Participants included in safety population\"\n  )\n) %>%\n  filter(var == \"Y\") %>%\n  select(var_label, starts_with(\"npct_\"))\nnames(pop) <- gsub(\"n_\", \"npct_\", names(pop))\ntbl_pop <- bind_rows(pop, pop1)\n\ntbl_pop %>% select(var_label, npct_0)## # A tibble: 4 × 2\n##   var_label                                    npct_0        \n##   <chr>                                        <chr>         \n## 1 Participants in Population                   \"  86\"        \n## 2 Participants included in ITT population      \"  86 (100.0)\"\n## 3 Participants included in efficacy population \"  79 ( 91.9)\"\n## 4 Participants included in safety population   \"  86 (100.0)\"\nrel_width <- c(2, rep(1, 3))\ncolheader <- \" | Placebo | Xanomeline line Low Dose| Xanomeline line High Dose\"\ntbl_pop %>%\n  # Table title\n  rtf_title(\n    \"Participants Accounting in Analysis Population\",\n    \"(All Participants Randomized)\"\n  ) %>%\n  # First row of column header\n  rtf_colheader(colheader,\n    col_rel_width = rel_width\n  ) %>%\n  # Second row of column header\n  rtf_colheader(\" | n (%) | n (%) | n (%)\",\n    border_top = \"\",\n    col_rel_width = rel_width\n  ) %>%\n  # Table body\n  rtf_body(\n    col_rel_width = rel_width,\n    text_justification = c(\"l\", rep(\"c\", 3))\n  ) %>%\n  # Encoding RTF syntax\n  rtf_encode() %>%\n  # Save to a file\n  write_rtf(\"tlf/tbl_pop.rtf\")"},{"path":"baseline-characteristics.html","id":"baseline-characteristics","chapter":"5 Baseline Characteristics","heading":"5 Baseline Characteristics","text":"Following ICH E3\nguidance,\nneed summarize critical demographic baseline characteristics\nparticipants Section 11.2, Demographic Baseline\nCharacteristics.chapter, illustrate create simplified baseline\ncharacteristics table study.many R packages can efficiently summarize baseline\ninformation. table1 R\npackage one .previous chapters, first read adsl dataset contain \nrequired information baseline characteristics table.simplicity, analyze SEX, AGE , RACE example\nusing table1 R package. details table R package can\nfound package\nvignettes.table1 R package directly creates HTML report.code transfer output data frame contain\nASCII character recommended regulatory agencies. tbl_base used\ninput r2rtf create final report.start define format output. highlight items \ndiscussed previous discussion.text_indent_first test_indent_left arguments used \ncontrol indent space text. helpful need \ncontrol white space long sentence. example, “AMERICAN\nINDIAN ALASKA NATIVE” table.procedure generate baseline characteristics table can \nsummarized follow:Step 1: Read data set.Step 2: Use table1::table1() get baseline characteristics\ntable.Step 3: Transfer output Step 2 data frame \ncontains ASCII characters.Step 4: Define format rtf table using R package\nr2rtf.","code":"\nlibrary(table1)\nlibrary(r2rtf)\nlibrary(haven)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(stringr)\nlibrary(tools)\nadsl <- read_sas(\"adam_data/adsl.sas7bdat\")\nana <- adsl %>% \n  mutate(SEX = factor(SEX, c(\"F\", \"M\"), c(\"Female\", \"Male\")), \n         RACE = toTitleCase(tolower(RACE))) \n\ntbl <- table1(~ SEX + AGE + RACE | TRT01P, data = ana)\ntbl\ntbl_base <- tbl %>% \n              as.data.frame() %>% \n              as_tibble() %>%\n              mutate( across(everything(), \n                      ~ str_replace_all(.x, intToUtf8(160), \" \") ) \n                    ) \n              \n\nnames(tbl_base) <- str_replace_all(names(tbl_base), intToUtf8(160), \" \")\ntbl_base## # A tibble: 11 × 5\n##    ` `              Placebo     `Xanomeline High … `Xanomeline Low … Overall    \n##    <chr>            <chr>       <chr>              <chr>             <chr>      \n##  1 \"\"               \"(N=86)\"    \"(N=84)\"           \"(N=84)\"          \"(N=254)\"  \n##  2 \"SEX\"            \"\"          \"\"                 \"\"                \"\"         \n##  3 \"  Female\"       \"53 (61.6%… \"40 (47.6%)\"       \"50 (59.5%)\"      \"143 (56.3…\n##  4 \"  Male\"         \"33 (38.4%… \"44 (52.4%)\"       \"34 (40.5%)\"      \"111 (43.7…\n##  5 \"Age\"            \"\"          \"\"                 \"\"                \"\"         \n##  6 \"  Mean (SD)\"    \"75.2 (8.5… \"74.4 (7.89)\"      \"75.7 (8.29)\"     \"75.1 (8.2…\n##  7 \"  Median [Min,… \"76.0 [52.… \"76.0 [56.0, 88.0… \"77.5 [51.0, 88.… \"77.0 [51.…\n##  8 \"RACE\"           \"\"          \"\"                 \"\"                \"\"         \n##  9 \"  Black or Afr… \"8 (9.3%)\"  \"9 (10.7%)\"        \"6 (7.1%)\"        \"23 (9.1%)\"\n## 10 \"  White\"        \"78 (90.7%… \"74 (88.1%)\"       \"78 (92.9%)\"      \"230 (90.6…\n## 11 \"  American Ind… \"0 (0%)\"    \"1 (1.2%)\"         \"0 (0%)\"          \"1 (0.4%)\"\ncolheader1 <- paste(names(tbl_base), collapse = \"|\")\ncolheader2 <- paste(tbl_base[1, ], collapse = \"|\")\nrel_width <- c(2.5, rep(1, 4))\n\ntbl_base[-1, ] %>% \n      rtf_title(\"Participant Baseline Characteristics\", \n                \"(All Participants Randomized)\") %>%\n      rtf_colheader(colheader1, \n                    col_rel_width = rel_width) %>% \n      rtf_colheader(colheader2, \n                    border_top = \"\",\n                    col_rel_width = rel_width) %>%\n      rtf_body(col_rel_width = rel_width,\n               text_justification = c(\"l\", rep(\"c\", 4)), \n               text_indent_first = -240,\n               text_indent_left = 180) %>% \n      rtf_encode() %>% \n      write_rtf(\"tlf/tlf_base.rtf\")"},{"path":"efficacy.html","id":"efficacy","chapter":"6 Efficacy","heading":"6 Efficacy","text":"Following ICH E3 guidance,\nneed summarize primary secondary efficacy endpoints,\nSection 11.4, Efficacy Results Tabulations Individual Participant.efficacy analysis, analyze change baseline glucose data Week 24.","code":"\nlibrary(haven)   # Read SAS data\nlibrary(dplyr)   # Manipulate data\nlibrary(tidyr)   # Manipulate data\nlibrary(r2rtf)   # Reporting in RTF format\nlibrary(emmeans) # LS mean estimation"},{"path":"efficacy.html","id":"analysis-dataset","chapter":"6 Efficacy","heading":"6.1 Analysis Dataset","text":"prepare analysis dataset,\nneed adsl adlbc datasets analysis.first define analysis dataset using\nefficacy population flag EFFFL \nrecords post baseline (AVISITN > 1) Week 24 (AVISITN <= 24).\nvariable AVISITN numerical analysis visit.\nexample, analysis visit recorded “Baseline”, .e., AVISIT = Baseline, AVISITN = 0;\nanalysis visit recorded “Week 24”, .e., AVISIT = Week 24, AVISITN = 24;\nanalysis visit blank, AVISITN also blank.\ndiscuss missing values Section 6.4.first records analysis dataset.AVAL: analysis valueBASE: baseline valueCHG: change baseline","code":"\nadsl <- read_sas(\"adam_data/adsl.sas7bdat\")\nadlb <- read_sas(\"adam_data/adlbc.sas7bdat\")\ngluc <- adlb %>%\n  left_join(adsl %>% select(USUBJID, EFFFL), by = \"USUBJID\") %>%\n  # PARAMCD is parameter code and here we focus on Glucose (mg/dL) \n  filter(EFFFL == \"Y\" & PARAMCD == \"GLUC\") %>% \n  arrange(TRTPN) %>% \n  mutate(TRTP = factor(TRTP, levels = unique(TRTP)))\n\nana <- gluc %>%\n  filter(AVISITN > 0 & AVISITN <= 24) %>%\n  arrange(AVISITN) %>%\n  mutate(AVISIT = factor(AVISIT, levels = unique(AVISIT)))\nana %>%\n  select(USUBJID, TRTPN, AVISIT, AVAL, BASE, CHG) %>%  \n  head(4)## # A tibble: 4 × 6\n##   USUBJID     TRTPN AVISIT              AVAL  BASE     CHG\n##   <chr>       <dbl> <fct>              <dbl> <dbl>   <dbl>\n## 1 01-701-1015     0 \"          Week 2\"  4.66  4.72 -0.0555\n## 2 01-701-1023     0 \"          Week 2\"  5.77  5.33  0.444 \n## 3 01-701-1047     0 \"          Week 2\"  5.55  5.55  0     \n## 4 01-701-1118     0 \"          Week 2\"  4.88  4.05  0.833"},{"path":"efficacy.html","id":"helper-functions-1","chapter":"6 Efficacy","heading":"6.2 Helper Functions","text":"prepare report dataframe, created helper functions\nusing fmt_num function defined Chapter 4.Format EstimatorsFormat Confidence IntervalFormat P-Value","code":"\nfmt_est <- function(.mean,\n                    .sd,\n                    digits = c(1, 2)) {\n  .mean <- fmt_num(.mean, digits[1], width = digits[1] + 4)\n  .sd <- fmt_num(.sd, digits[2], width = digits[2] + 3)\n  paste0(.mean, \" (\", .sd, \")\")\n}\nfmt_ci <- function(.est,\n                   .lower,\n                   .upper,\n                   digits = 2,\n                   width = digits + 3) {\n  .est <- fmt_num(.est, digits, width)\n  .lower <- fmt_num(.lower, digits, width)\n  .upper <- fmt_num(.upper, digits, width)\n  paste0(.est, \" (\", .lower, \",\", .upper, \")\")\n}\nfmt_pval <- function(.p, digits = 3) {\n  scale <- 10^(-1 * digits)\n  p_scale <- paste0(\"<\", digits)\n  if_else(.p < scale, p_scale, fmt_num(.p, digits = digits))\n}"},{"path":"efficacy.html","id":"summary-of-observed-data","chapter":"6 Efficacy","heading":"6.3 Summary of Observed Data","text":"first summarize observed data Baseline Week 24We also summarize observed change baseline glucose Week 24.","code":"\nt11 <- gluc %>%\n  filter(AVISITN %in% c(0, 24)) %>%\n  group_by(TRTPN, TRTP, AVISITN) %>%\n  summarise(\n    n = n(),\n    mean_sd = fmt_est(mean(AVAL), sd(AVAL))\n  ) %>%\n  pivot_wider(\n    id_cols = c(TRTP, TRTPN),\n    names_from = AVISITN,\n    values_from = c(n, mean_sd)\n  )\n\nt11## # A tibble: 3 × 6\n## # Groups:   TRTPN, TRTP [3]\n##   TRTP                 TRTPN   n_0  n_24 mean_sd_0       mean_sd_24     \n##   <fct>                <dbl> <int> <int> <chr>           <chr>          \n## 1 Placebo                  0    79    57 \"  5.7 ( 2.23)\" \"  5.7 ( 1.83)\"\n## 2 Xanomeline Low Dose     54    79    26 \"  5.4 ( 0.95)\" \"  5.7 ( 1.26)\"\n## 3 Xanomeline High Dose    81    74    30 \"  5.4 ( 1.37)\" \"  6.0 ( 1.92)\"\nt12 <- gluc %>%\n  filter(AVISITN %in% 24) %>%\n  group_by(TRTPN, AVISITN) %>%\n  summarise(\n    n_chg = n(),\n    mean_chg = fmt_est(\n      mean(CHG, na.rm = TRUE),\n      sd(CHG, na.rm = TRUE)\n    )\n  )\n\nt12## # A tibble: 3 × 4\n## # Groups:   TRTPN [3]\n##   TRTPN AVISITN n_chg mean_chg       \n##   <dbl>   <dbl> <int> <chr>          \n## 1     0      24    57 \" -0.1 ( 2.68)\"\n## 2    54      24    26 \"  0.2 ( 0.82)\"\n## 3    81      24    30 \"  0.5 ( 1.94)\""},{"path":"efficacy.html","id":"missing-data-imputation","chapter":"6 Efficacy","heading":"6.4 Missing Data Imputation","text":"clinical trials, missing data inevitable.\nstudy, also missing values glucose data.simplicity illustration purpose,\nuse last observation carried forward (LOCF) approach handle missing data.\nLOCF approach single imputation approach recommended\nreal studies.\nInterested readers can find discussion missing data approaches book:\nPrevention Treatment Missing Data Clinical Trials.","code":"\ncount(ana, AVISIT)## # A tibble: 8 × 2\n##   AVISIT                 n\n##   <fct>              <int>\n## 1 \"          Week 2\"   229\n## 2 \"          Week 4\"   211\n## 3 \"          Week 6\"   197\n## 4 \"          Week 8\"   187\n## 5 \"         Week 12\"   167\n## 6 \"         Week 16\"   147\n## 7 \"         Week 20\"   126\n## 8 \"         Week 24\"   113\nana_locf <- ana %>%\n  group_by(USUBJID) %>%\n  mutate(locf = AVISITN == max(AVISITN)) %>%\n  filter(locf)"},{"path":"efficacy.html","id":"ancova-model","chapter":"6 Efficacy","heading":"6.5 ANCOVA model","text":"start analyze imputed data using ANCOVA model treatment baseline glucose covariates.use emmeans R package obtain\nwithin group least square mean (LS mean)","code":"\nfit <- lm(CHG ~ BASE + TRTP, data = ana_locf)\nsummary(fit)## \n## Call:\n## lm(formula = CHG ~ BASE + TRTP, data = ana_locf)\n## \n## Residuals:\n##     Min      1Q  Median      3Q     Max \n## -6.9907 -0.7195 -0.2367  0.2422  7.0754 \n## \n## Coefficients:\n##                          Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)               3.00836    0.39392   7.637 6.23e-13 ***\n## BASE                     -0.53483    0.06267  -8.535 2.06e-15 ***\n## TRTPXanomeline Low Dose  -0.17367    0.24421  -0.711    0.478    \n## TRTPXanomeline High Dose  0.32983    0.24846   1.327    0.186    \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 1.527 on 226 degrees of freedom\n##   (2 observations deleted due to missingness)\n## Multiple R-squared:  0.2567, Adjusted R-squared:  0.2468 \n## F-statistic: 26.01 on 3 and 226 DF,  p-value: 1.714e-14\nfit_within <- emmeans(fit, \"TRTP\")\nfit_within##  TRTP                  emmean    SE  df lower.CL upper.CL\n##  Placebo               0.0676 0.172 226   -0.272    0.407\n##  Xanomeline Low Dose  -0.1060 0.173 226   -0.447    0.235\n##  Xanomeline High Dose  0.3975 0.179 226    0.045    0.750\n## \n## Confidence level used: 0.95\nt13 <- fit_within %>%\n  as_tibble() %>%\n  mutate(ls = fmt_ci(emmean, lower.CL, upper.CL)) %>%\n  select(TRTP, ls)\nt13## # A tibble: 3 × 2\n##   TRTP                 ls                   \n##   <fct>                <chr>                \n## 1 Placebo              \" 0.07 (-0.27, 0.41)\"\n## 2 Xanomeline Low Dose  \"-0.11 (-0.45, 0.23)\"\n## 3 Xanomeline High Dose \" 0.40 ( 0.05, 0.75)\"\nfit_between <- pairs(fit_within, reverse = TRUE)\nfit_between##  contrast                                   estimate    SE  df t.ratio p.value\n##  Xanomeline Low Dose - Placebo                -0.174 0.244 226  -0.711  0.7571\n##  Xanomeline High Dose - Placebo                0.330 0.248 226   1.327  0.3814\n##  Xanomeline High Dose - Xanomeline Low Dose    0.504 0.249 226   2.024  0.1087\n## \n## P value adjustment: tukey method for comparing a family of 3 estimates\nt2 <- fit_between %>%\n  as_tibble() %>%\n  mutate(\n    ls = fmt_ci(\n      estimate,\n      estimate - 1.96 * SE,\n      estimate + 1.96 * SE\n    ),\n    p = fmt_pval(p.value)\n  ) %>%\n  filter(str_detect(contrast, \"- Placebo\")) %>%\n  select(contrast, ls, p)\n\nt2## # A tibble: 2 × 3\n##   contrast                       ls                    p        \n##   <chr>                          <chr>                 <chr>    \n## 1 Xanomeline Low Dose - Placebo  \"-0.17 (-0.65, 0.30)\" \"  0.757\"\n## 2 Xanomeline High Dose - Placebo \" 0.33 (-0.16, 0.82)\" \"  0.381\""},{"path":"efficacy.html","id":"reporting","chapter":"6 Efficacy","heading":"6.6 Reporting","text":"combine t11, t12 t13 get first part report dataThen use r2rtf prepare table format t1.\nalso highlight handle special character example.Special characters ^ _ used define superscript subscript text. {} define part impacted.\nexample, {^} provide superscript footnote notation.r2rtf also support LaTeX characters.\nExamples can found \nr2rtf Get Started Page.\ntext_convert argument r2rtf_xxx functions control whether convert special characters.also use r2rtf prepare table format t2Finally combine two parts get final table using r2rtf.\nachieved providing list t1_rtf t2_rtf input \nrtf_encode.conclusion, procedure generate efficacy results table summarized follows.Step 1: Read data R, .e., adsl adlb.Step 2: Define analysis dataset. example, define two analysis datasets. first dataset efficacy population (gluc). second dataset collection records post baseline week 24 (ana).Step 3: Impute missing values. example, name ana dataset imputation ana_locf.Step 4: Summarize gluc, .e., calculate mean standard derivation, format rtf table.Step 5: Summarize ana_locf, .e., calculate pairwise comparison ANCOVA model, format rtf table.Step 6: Rowly bind output Step 4 Step 5.","code":"\nt1 <- cbind(\n  t11 %>% ungroup() %>% select(TRTP, ends_with(\"0\"), ends_with(\"24\")),\n  t12 %>% ungroup() %>% select(ends_with(\"chg\")),\n  t13 %>% ungroup() %>% select(ls)\n)\nt1##                   TRTP n_0     mean_sd_0 n_24    mean_sd_24 n_chg      mean_chg\n## 1              Placebo  79   5.7 ( 2.23)   57   5.7 ( 1.83)    57  -0.1 ( 2.68)\n## 2  Xanomeline Low Dose  79   5.4 ( 0.95)   26   5.7 ( 1.26)    26   0.2 ( 0.82)\n## 3 Xanomeline High Dose  74   5.4 ( 1.37)   30   6.0 ( 1.92)    30   0.5 ( 1.94)\n##                    ls\n## 1  0.07 (-0.27, 0.41)\n## 2 -0.11 (-0.45, 0.23)\n## 3  0.40 ( 0.05, 0.75)\nt1_rtf <- t1 %>% \n  data.frame() %>%\n  rtf_title(c(\n    \"ANCOVA of Change from Baseline Glucose (mmol/L) at Week 24\",\n    \"LOCF\",\n    \"Efficacly Analysis Population\"\n  )) %>%\n  rtf_colheader(\"| Baseline | Week 24 | Change from Baseline\",\n    col_rel_width = c(2.5, 2, 2, 4)\n  ) %>%\n  rtf_colheader(paste(\n    \"Treatment |\",\n    paste0(rep(\"N | Mean (SD) | \", 3), collapse = \"\"),\n    \"LS Mean (95% CI){^a}\"\n  ),\n  col_rel_width = c(2.5, rep(c(0.5, 1.5), 3), 2)\n  ) %>%\n  rtf_body(text_justification = c(\"l\", rep(\"c\", 7)), \n           col_rel_width = c(2.5, rep(c(0.5, 1.5), 3), 2)) %>%\n  rtf_footnote(c(\n    \"{^a}Based on an ANCOVA model after adjusting baseline value. LOCF approach is used to impute missing values.\",\n    \"ANCOVA = Analysis of Covariance, LOCF = Last Observation Carried Forward\",\n    \"CI = Confidence Interval, LS = Least Squares, SD = Standard Deviation\"\n  ))\n\nt1_rtf %>%\n  rtf_encode() %>%\n  write_rtf(\"tlf/tlf_eff1.rtf\")\nt2_rtf <- t2 %>% \n  data.frame() %>%\n  rtf_colheader(\"Pairwise Comparison | Difference in LS Mean (95% CI){^a} | p-Value\",\n    col_rel_width = c(4.5, 4, 2)\n  ) %>%\n  rtf_body(text_justification = c(\"l\", \"c\", \"c\"), \n           col_rel_width = c(4.5, 4, 2))\n\nt2_rtf %>%\n  rtf_encode() %>%\n  write_rtf(\"tlf/tlf_eff2.rtf\")\nlist(t1_rtf, t2_rtf) %>%\n  rtf_encode() %>%\n  write_rtf(\"tlf/tlf_eff.rtf\")"},{"path":"aesummary.html","id":"aesummary","chapter":"7 AE Summary","heading":"7 AE Summary","text":"Following ICH E3 guidance,\nneed summarize participants included efficacy analysis Section 12.2, Adverse Events (AEs).chapter, illustrate summarize AE information study.data used summarize AE information adsl adae datasets.first summarize participants population treatment group.transform data simplify analysis required AE criteria interest.one adverse eventsWith drug-related adverse eventsWith serious adverse eventsWith serious drug-related adverse eventsWho “died”summarize number percentage participants meet AE criteria.prepare reporting-ready dataset AE criteria.prepare reporting-ready dataset analysis population.final report data saved tbl_ae_summary.start define format output.procedure generate AE summary table can summarized follow：Step 1: Read data R, .e., adae adsl.Step 2: Summarize participants population treatment group, name dataset t_pop.Step 3: Summarize participants population required AE criteria interest, name dataset t_ae.Step 4: Rowly bind t_pop t_ae format r2rtf.","code":"\nlibrary(haven) # Read SAS data\nlibrary(dplyr) # Manipulate data\nlibrary(tidyr) # Manipulate data\nlibrary(r2rtf) # Reporting in RTF format\nadsl <- read_sas(\"adam_data/adsl.sas7bdat\")\nadae <- read_sas(\"adam_data/adae.sas7bdat\")\npop <- adsl %>%\n  filter(SAFFL == \"Y\") %>%\n  rename(TRTAN = TRT01AN) %>%\n  count(TRTAN, name = \"tot\")\n\npop## # A tibble: 3 × 2\n##   TRTAN   tot\n##   <dbl> <int>\n## 1     0    86\n## 2    54    84\n## 3    81    84\ntidy_ae <- adae %>%\n  mutate(\n    all = SAFFL == \"Y\",\n    drug = AEREL %in% c(\"POSSIBLE\", \"PROBABLE\"),\n    ser = AESER == \"Y\",\n    drug_ser = drug & ser,\n    die = AEOUT == \"FATAL\"\n  ) %>%\n  select(USUBJID, TRTAN, all, drug, ser, drug_ser, die) %>%\n  pivot_longer(cols = c(all, drug, ser, drug_ser, die))\n\ntidy_ae %>% head(4)## # A tibble: 4 × 4\n##   USUBJID     TRTAN name     value\n##   <chr>       <dbl> <chr>    <lgl>\n## 1 01-701-1015     0 all      TRUE \n## 2 01-701-1015     0 drug     TRUE \n## 3 01-701-1015     0 ser      FALSE\n## 4 01-701-1015     0 drug_ser FALSE\nana <- tidy_ae %>%\n  filter(value == TRUE) %>%\n  group_by(TRTAN, name) %>%\n  summarise(n = n_distinct(USUBJID)) %>%\n  left_join(pop, by = \"TRTAN\") %>%\n  mutate(\n    pct = fmt_num(n / tot * 100, digits = 1),\n    n = fmt_num(n, digits = 0),\n    pct = paste0(\"(\", pct, \")\")\n  )\n\nana %>% head(4)## # A tibble: 4 × 5\n## # Groups:   TRTAN [2]\n##   TRTAN name  n        tot pct    \n##   <dbl> <chr> <chr>  <int> <chr>  \n## 1     0 all   \"  69\"    86 ( 80.2)\n## 2     0 die   \"   2\"    86 (  2.3)\n## 3     0 drug  \"  44\"    86 ( 51.2)\n## 4    54 all   \"  77\"    84 ( 91.7)\nt_ae <- ana %>%\n  pivot_wider(\n    id_cols = \"name\",\n    names_from = TRTAN,\n    values_from = c(n, pct),\n    values_fill = list(\n      n = \"   0\",\n      pct = \"(  0.0)\"\n    )\n  )\n\nt_ae <- t_ae %>%\n  mutate(name = factor(\n    name,\n    c(\"all\", \"drug\", \"ser\", \"drug_ser\", \"die\"),\n    c(\n      \"With one or more adverse events\",\n      \"With drug-related adverse events\",\n      \"With serious adverse events\",\n      \"With serious drug-related adverse events\",\n      \"Who died\"\n    )\n  )) %>%\n  arrange(name)\nt_pop <- pop %>% \n  mutate(name = \"Participants in population\", \n         tot = fmt_num(tot, digits = 0)) %>% \n  pivot_wider(id_cols = name, \n              names_from = TRTAN, \n              names_prefix = \"n_\", \n              values_from = tot) \n\nt_pop## # A tibble: 1 × 4\n##   name                       n_0    n_54   n_81  \n##   <chr>                      <chr>  <chr>  <chr> \n## 1 Participants in population \"  86\" \"  84\" \"  84\"\ntbl_ae_summary <- bind_rows(t_pop, t_ae) %>%\n  select(name, ends_with(\"_0\"), ends_with(\"_54\"), ends_with(\"_81\"))\n\ntbl_ae_summary## # A tibble: 6 × 7\n##   name                                     n_0    pct_0 n_54  pct_54 n_81  pct_81\n##   <chr>                                    <chr>  <chr> <chr> <chr>  <chr> <chr> \n## 1 Participants in population               \"  86\" <NA>  \"  8… <NA>   \"  8… <NA>  \n## 2 With one or more adverse events          \"  69\" ( 80… \"  7… ( 91.… \"  7… ( 94.…\n## 3 With drug-related adverse events         \"  44\" ( 51… \"  7… ( 86.… \"  7… ( 83.…\n## 4 With serious adverse events              \"   0\" (  0… \"   … (  1.… \"   … (  2.…\n## 5 With serious drug-related adverse events \"   0\" (  0… \"   … (  1.… \"   … (  1.…\n## 6 Who died                                 \"   2\" (  2… \"   … (  1.… \"   … (  0.…\ntbl_ae_summary %>% \n  rtf_title(\n    \"Analysis of Adverse Event Summary\",\n    \"(Safety Analysis Population)\"\n  ) %>%\n  rtf_colheader(\" | Placebo | Xanomeline Low Dose| Xanomeline High Dose\",\n    col_rel_width = c(3.5, rep(2, 3))\n  ) %>%\n  rtf_colheader(\" | n | (%) | n | (%) | n | (%)\",\n    col_rel_width = c(3.5, rep(c(0.7, 1.3), 3)),\n    border_top = c(\"\", rep(\"single\", 6)),\n    border_left = c(\"single\", rep(c(\"single\", \"\"), 3))\n  ) %>%\n  rtf_body(\n    col_rel_width = c(3.5, rep(c(0.7, 1.3), 3)),\n    text_justification = c(\"l\", rep(\"c\", 6)),\n    border_left = c(\"single\", rep(c(\"single\", \"\"), 3))\n  ) %>%\n  rtf_footnote(\"Every subject is counted a single time for each applicable row and column.\") %>%\n  rtf_encode() %>%\n  write_rtf(\"tlf/tlf_ae_summary.rtf\")"},{"path":"specific-ae.html","id":"specific-ae","chapter":"8 Specific AE","heading":"8 Specific AE","text":"Following ICH E3\nguidance,\nneed summarize participants included efficacy\nanalysis Section 12.2, Adverse Events (AEs).chapter, illustrate summarize simplified specific AE\ninformation study.data used summarize AE information adsl adae\ndatasets.illustration purposes, provide count simplified\ntable. percentage participants AE criteria can \ncalculated Chapter 7.way, let’s focus analysis script two advanced\nfeatures table layout.group content: AE can summarized multiple nested layers. (e.g.\nsystem organ class (SOC, AESOC) specific AE term\n(AEDECOD))pagenization: many AE terms can covered one\npage. Column headers SOC information need repeated \nevery page.code , count number subjects AE term \nSOC treatment group, create new variable order set \n0 counted numbers. variable order help \ndata manipulation later.code , count number subjects AE term \nSOC, AE term, treatment group. also create new variable\norder set 1 counted numbers.prepare reporting data AE information.prepare reporting data analysis population.final report data saved tbl_ae_spec. also add blank row\npopulation AE information reporting table.start define format output.obtain nested layout, use page_by argument \nrtf_body function. defining page_by=\"AESOC\", r2rtf recognize\nvariable group indicator.setting pageby_row = \"first_row\", first row displayed \ngroup header. group information broken multiple pages,\ngroup header row repeated page default.can also customize text format providing matrix \ndimension input dataset (.e. tbl_ae_spec). code\n, illustrate display bold text group headers \nhighlight nested structure table layout.discussion page_by, group_by, subline_by features can\nfound r2rtf package\nwebsite.procedure generate baseline characteristics table can \nsummarized follow:Step 1: Read data R, .e., adae adsl.Step 2: Count number subjects SOC treatment group\n(rows bold text) save t1.Step 3: Count number subjects AE term SOC, AE\nterm, treatment group (rows without bold text) save \nt2.Step 4: Bind t1 t2 row t_ae.Step 5: Count number subjects arm t_pop.Step 6: Bind t_pop t_ae row tbl_ae_spec.Step 7: Format output r2rtf.","code":"\nlibrary(haven) # Read SAS data\nlibrary(dplyr) # Manipulate data\nlibrary(tidyr) # Manipulate data\nlibrary(r2rtf) # Reporting in RTF format\nadsl <- read_sas(\"adam_data/adsl.sas7bdat\")\nadae <- read_sas(\"adam_data/adae.sas7bdat\")\nana <- adae %>% \n  mutate(AESOC = toTitleCase(tolower(AESOC)), \n         AEDECOD =  toTitleCase(tolower(AEDECOD)))\n\nt1 <-ana %>% \n  group_by(TRTAN, AESOC) %>%\n  summarise(n = fmt_num(n_distinct(USUBJID), digits = 0)) %>% \n  mutate(AEDECOD = AESOC, order = 0)\n\nt1 %>% head(4)## # A tibble: 4 × 5\n## # Groups:   TRTAN [1]\n##   TRTAN AESOC                       n      AEDECOD                     order\n##   <dbl> <chr>                       <chr>  <chr>                       <dbl>\n## 1     0 Cardiac Disorders           \"  13\" Cardiac Disorders               0\n## 2     0 Ear and Labyrinth Disorders \"   1\" Ear and Labyrinth Disorders     0\n## 3     0 Eye Disorders               \"   4\" Eye Disorders                   0\n## 4     0 Gastrointestinal Disorders  \"  17\" Gastrointestinal Disorders      0\nt2 <- ana %>% \n  group_by(TRTAN, AESOC, AEDECOD) %>%\n  summarise(n = fmt_num(n_distinct(USUBJID), digits = 0)) %>%\n  mutate(order = 1)\n  \nt2 %>% head(4)## # A tibble: 4 × 5\n## # Groups:   TRTAN, AESOC [1]\n##   TRTAN AESOC             AEDECOD                              n      order\n##   <dbl> <chr>             <chr>                                <chr>  <dbl>\n## 1     0 Cardiac Disorders Atrial Fibrillation                  \"   1\"     1\n## 2     0 Cardiac Disorders Atrial Hypertrophy                   \"   1\"     1\n## 3     0 Cardiac Disorders Atrioventricular Block First Degree  \"   1\"     1\n## 4     0 Cardiac Disorders Atrioventricular Block Second Degree \"   2\"     1\nt_ae <- bind_rows(t1, t2) %>% \n        pivot_wider(id_cols = c(AESOC, order, AEDECOD), \n                    names_from = TRTAN, \n                    names_prefix = \"n_\",\n                    values_from = n, \n                    values_fill = fmt_num(0, digits = 0)) %>%\n        arrange(AESOC, order, AEDECOD) %>% \n        select(AESOC, AEDECOD, starts_with(\"n\"))\n\nt_ae %>% head(4)## # A tibble: 4 × 5\n##   AESOC             AEDECOD             n_0    n_54   n_81  \n##   <chr>             <chr>               <chr>  <chr>  <chr> \n## 1 Cardiac Disorders Cardiac Disorders   \"  13\" \"  13\" \"  18\"\n## 2 Cardiac Disorders Atrial Fibrillation \"   1\" \"   1\" \"   3\"\n## 3 Cardiac Disorders Atrial Flutter      \"   0\" \"   1\" \"   1\"\n## 4 Cardiac Disorders Atrial Hypertrophy  \"   1\" \"   0\" \"   0\"\nt_pop <- adsl %>%\n  filter(SAFFL == \"Y\") %>%\n  count_by(\"TRT01AN\", \"SAFFL\",\n    var_label = \"Participants in population\"\n  ) %>%\n  mutate(\n    AESOC = \"pop\", \n    AEDECOD = var_label) %>%\n  select(AESOC,AEDECOD, starts_with(\"n_\"))\n\nt_pop## # A tibble: 1 × 5\n##   AESOC AEDECOD                    n_0    n_54   n_81  \n##   <chr> <chr>                      <chr>  <chr>  <chr> \n## 1 pop   Participants in population \"  86\" \"  84\" \"  84\"\ntbl_ae_spec <- bind_rows(t_pop,\n                         data.frame(AESOC = \"pop\"), \n                         t_ae) %>% \n  mutate(AEDECOD = ifelse(AEDECOD == AESOC , \n                          AEDECOD, paste0(\"  \", AEDECOD)))\n\ntbl_ae_spec %>% head(4)## # A tibble: 4 × 5\n##   AESOC             AEDECOD                        n_0    n_54   n_81  \n##   <chr>             <chr>                          <chr>  <chr>  <chr> \n## 1 pop               \"  Participants in population\" \"  86\" \"  84\" \"  84\"\n## 2 pop                <NA>                           <NA>   <NA>   <NA> \n## 3 Cardiac Disorders \"Cardiac Disorders\"            \"  13\" \"  13\" \"  18\"\n## 4 Cardiac Disorders \"  Atrial Fibrillation\"        \"   1\" \"   1\" \"   3\"\nn_row <- nrow(tbl_ae_spec)\nn_col <- ncol(tbl_ae_spec)\nid <- tbl_ae_spec$AESOC == tbl_ae_spec$AEDECOD\nid <- ifelse(is.na(id), FALSE, id)\n\ntext_format   <- ifelse(id, \"b\", \"\")\ntbl_ae_spec %>% \n  rtf_title(\"Analysis of Participants With Specific Adverse Events\", \n            \"(Safty Analysis Population)\") %>%\n  \n    rtf_colheader(\" | Placebo | Xanomeline Low Dose| Xanomeline High Dose\",\n    col_rel_width = c(3, rep(1, 3))\n  ) %>%\n  rtf_colheader(\" | n |  n | n \",\n    border_top = \"\",\n    border_bottom = \"single\",\n    col_rel_width = c(3, rep(1, 3))\n  ) %>%\n  \n  rtf_body(\n    col_rel_width = c(1, 3, rep(1, 3)),\n    text_justification = c(\"l\", \"l\", rep(\"c\", 3)),\n    text_format = matrix(text_format, nrow = n_row, ncol = n_col), \n    page_by = \"AESOC\", \n    pageby_row = \"first_row\") %>% \n  \n  rtf_footnote(\"Every subject is counted a single time for each applicable row and column.\") %>%\n  \n  rtf_encode() %>%\n  \n  write_rtf(\"tlf/tlf_spec_ae.rtf\")"},{"path":"overview-1.html","id":"overview-1","chapter":"9 Overview","heading":"9 Overview","text":"ToDo","code":""},{"path":"manage.html","id":"manage","chapter":"10 Project Management","heading":"10 Project Management","text":"ToDo","code":""},{"path":"ectd.html","id":"ectd","chapter":"11 eCTD","heading":"11 eCTD","text":"ToDo:introduce eCTD","code":""},{"path":"submission-package.html","id":"submission-package","chapter":"12 Submission Package","heading":"12 Submission Package","text":"ToDo:add pkglite cleanslate information","code":""},{"path":"reference.html","id":"reference","chapter":"13 Reference","heading":"13 Reference","text":"Marwick, Ben, Carl Boettiger, Lincoln Mullen. 2018. “Packaging Data Analytical Work Reproducibly Using R (Friends).” American Statistician 72 (1): 80–88.","code":""}]
